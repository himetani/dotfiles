#!/bin/sh

function error() {
  echo -e "[ERROR] " $1
  exit 1
}

function info() {
  echo -e "[INFO] " $1
}

if [ ! `builtin command -v brew` ]; then
  error 'Install homebrew before executing this install script.'
fi

info 'Install nord-iterm2'
if [ ! -d $HOME/git/nord-iterm2-0.2.0 ]; then
  curl -L -o $HOME/git/nord-iterm2-0.2.0.zip https://github.com/arcticicestudio/nord-iterm2/archive/refs/tags/v0.2.0.zip
  unzip -d $HOME/git $HOME/git/nord-iterm2-0.2.0.zip
  rm $HOME/git/nord-iterm2-0.2.0.zip
else
  info 'nord-iterm2 is already installed' 
fi

# tpm
info 'Install tpm'
if [ ! -e $HOME/.tmux/plugins/tpm ]; then
  info 'Install tpm'
  git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
else
  info 'tpm is already installed' 
fi

# monaco nerd fonts
info 'Install monaco nerd fonts'
if [ ! -d $HOME/git/monaco-nerd-fonts ]; then
  info 'Install monaco-nerd-fonts'
  git clone https://github.com/Karmenzind/monaco-nerd-fonts.git $HOME/git/monaco-nerd-fonts
  cp $HOME/git/monaco-nerd-fonts/fonts/* $HOME/Library/fonts
else
  info 'monaco nerd fonts are already installed' 
fi

# brew
info 'Install homebrew formulae'
brew install go tig fzf tmux starship zsh-autosuggestions gsed kubectl direnv htop fontconfig git-extras yarn tree fd jq ctags direnv
brew tap homebrew/cask-fonts
brew install --cask font-hack-nerd-font iterm2 vivaldi docker
brew install --HEAD neovim

info 'Install fzf'
if [ ! -e $HOME/.fzf.zsh ]; then
  info 'Install fzf'
  $(brew --prefix)/opt/fzf/install
else
  info 'fzf is already installed' 
fi

# Language server
info 'Install Language servers'
yarn global add bash-language-server

# zsh
info 'Install .zshrc'
if [ ! -h $HOME/.zshrc ]; then
  echo '=> ln -sn $HOME/git/dotfiles/zshrc $HOME/.zshrc'
  ln -sn $HOME/git/dotfiles/zshrc $HOME/.zshrc
else
  info '.zshrc is already installed' 
fi

# tmux 
info 'Install .tmux.conf'
if [ ! -h $HOME/.tmux.conf ]; then
  echo '=> ln -sn $HOME/git/dotfiles/tmux.conf $HOME/.tmux.conf'
  ln -sn $HOME/git/dotfiles/tmux.conf $HOME/.tmux.conf
else
  info '.tmux.conf is already installed' 
fi

# vim-plug
info 'Install vim-plug'
if [ ! -e $HOME/.local/share/nvim/site/autoload/plug.vim ]; then
  sh -c 'curl -fLo "${XDG_DATA_HOME:-$HOME/.local/share}"/nvim/site/autoload/plug.vim --create-dirs \
    https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim'
    else
      info 'vim-plug is already installed' 
fi

# nvim
info 'Install nvim configurations'
if [ ! -h $HOME/.config/nvim ]; then
  echo '=> ln -sn $HOME/git/dotfiles/nvim $HOME/.config/nvim'
  ln -sn $HOME/git/dotfiles/nvim $HOME/.config/nvim
else
  info 'nvim configurations is already installed' 
fi

# tig
info 'Install .tigrc'
if [ ! -h $HOME/.tigrc ]; then
  echo '=> ln -sn $HOME/git/dotfiles/tigrc $HOME/.tigrc'
  ln -sn $HOME/git/dotfiles/tigrc $HOME/.tigrc
else
  info '.tigrc is already installed' 
fi

# gitcoinfg
info 'Install git configurations'
if [ ! -h $HOME/.gitconfig ]; then
  echo '=> ln -sn $HOME/git/dotfiles/gitconfig $HOME/git/.gitconfig'
  ln -sn $HOME/git/dotfiles/gitconfig $HOME/.gitconfig
else
  info '$HOME/.gitconfig is already installed' 
fi
if [ ! -h $HOME/git/private/gitconfig ]; then
  mkdir -p $HOME/git/private
  echo '=> ln -sn $HOME/git/dotfiles/gitconfig $HOME/git/private/gitconfig'
  ln -sn $HOME/git/dotfiles/gitconfig-private $HOME/git/private/gitconfig
else
  info '$HOME/git/private/gitconfig is already installed' 
fi

# starship
info 'Install starship.toml'
if [ ! -h $HOME/.config/starship.toml ]; then
  mkdir -p $HOME/.config
  echo '=> ln -sn $HOME/git/dotfiles/starship.toml $HOME/.config/starship.toml'
  ln -sn $HOME/git/dotfiles/starship.toml $HOME/.config/starship.toml
else
  info 'starship.toml is already installed' 
fi


# gopls
info 'Install gopls' 
go install golang.org/x/tools/gopls@latest
